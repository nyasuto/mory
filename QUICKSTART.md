# 🦔 Mory Python版完全セットアップガイド

このガイドでは、Claude DesktopでMory Python実装のセットアップと使用方法を詳しく説明します。

## 🚀 クイックセットアップ（5分）

### 1. Python環境のセットアップ
```bash
# プロジェクトのクローン
git clone https://github.com/nyasuto/mory.git
cd mory

# Python仮想環境の作成
python3 -m venv venv

# 仮想環境の有効化
source venv/bin/activate        # Linux/macOS
# venv\Scripts\activate         # Windows

# 依存関係のインストール
pip install -e .

# 動作確認
python main.py --help
```

### 2. Claude Desktopの設定

Claude Desktop設定ファイルを編集します：

**macOS**: `~/Library/Application Support/Claude/claude_desktop_config.json`  
**Windows**: `%APPDATA%\Claude\claude_desktop_config.json`

```json
{
  "mcpServers": {
    "mory": {
      "command": "python",
      "args": ["/full/path/to/mory/main.py"],
      "env": {
        "PYTHONPATH": "/full/path/to/mory/src"
      }
    }
  }
}
```

> **重要**: `/full/path/to/mory/main.py` と `/full/path/to/mory/src` を実際の絶対パスに置き換えてください

### 3. Claude Desktopの再起動

設定を有効にするため、Claude Desktopを完全にシャットダウンして再起動してください。

## 🧪 セットアップのテスト

### 基本メモリテスト
Claude Desktopで以下の会話を試してください：

```
あなた: 私の誕生日は1990年5月15日です。記憶してください。
Claude: [save_memory ツール実行] ✅ 誕生日を記憶しました！

あなた: 私について何か知ってる？
Claude: [list_memories ツール実行] はい、以下の情報を記憶しています：
- 誕生日: 1990年5月15日
```

これが動作すれば、基本セットアップは完了です！🎉

## 🔍 Python版の主要機能

### 検索機能

検索機能は基本セットアップ後すぐに使用できます：

```
あなた: プログラミングに関する記憶を検索して
Claude: [search_memories ツール実行] 関連度スコア付きでプログラミング関連の記憶を発見
```

**検索機能の特徴:**
- ✅ 全文検索（値、カテゴリ、タグを対象）
- ✅ 関連度スコアリング（0.0 - 1.0）
- ✅ カテゴリフィルタリング
- ✅ 結果の自動ソート

### 現在利用可能なツール

1. **save_memory**: 情報の保存
2. **get_memory**: ID/キーによる取得
3. **list_memories**: 一覧表示（カテゴリフィルタ可）
4. **search_memories**: 高度な検索
5. **delete_memory**: メモリの削除

### 将来の機能（開発予定）

- 🚧 **Obsidian連携**: ノートインポート/エクスポート
- 🚧 **セマンティック検索**: sentence-transformersによる意味検索
- 🚧 **AI自動分類**: 自動カテゴリ化・タグ付け

#### 削除機能のテスト
```
あなた: "古いメモ"という記憶を削除して
Claude: [delete_memory ツール実行] 指定されたメモリを正常に削除しました
```

## 📖 完全機能ガイド

### 1. コアメモリ操作

#### 情報の保存
```
あなた: 私の好きな色は青です。覚えておいて
→ カテゴリと自動生成IDでメモリに保存

あなた: メモ：Goの学習を開始した
→ 学習関連のメモリとして保存

あなた: 重要：プロジェクトの締切は来月15日
→ 高優先度の指示付きで保存
```

#### 情報の取得
```
あなた: 私の好きな色は？
→ 色の好みを検索して取得

あなた: 私について知っていることを全部教えて
→ 保存されたすべてのメモリを時系列で一覧表示
```

### 2. 高度な検索（Phase 2）

#### スコアリング付きテキスト検索
```
あなた: プログラミングに関する記憶を検索
→ 関連度スコアリング付き全文検索
→ 類似度でランク付けされた結果

あなた: API設計について何か覚えてる？
→ API関連コンテンツを検索
→ 信頼度スコア付きでマッチを表示
```

#### カテゴリフィルタリング
```
あなた: 学習カテゴリの記憶だけ検索して
→ 特定カテゴリ内での検索
→ より精密な結果

あなた: 仕事関連で "締切" を含む記憶を探して
→ カテゴリとキーワードの組み合わせ検索
```

### 3. Obsidian連携（Phase 2）

#### ノートのインポート

**ボルト全体のインポート：**
```
あなた: Obsidianボルト全体をインポートして
→ ボルトからすべての.mdファイルをインポート
→ フォルダ構造によって自動的にカテゴリ分類
→ タグとフロントマターを抽出
```

**カテゴリ特定のインポート：**
```
あなた: Obsidianの"学習"フォルダだけインポート
→ 特定のフォルダ/カテゴリをインポート
→ フォルダ構造をカテゴリとして保持
```

**高度なインポートオプション：**
```
あなた: ドライランでObsidianインポートを確認
→ インポートされる内容をプレビュー
→ 実際のデータ変更なし

あなた: 重複をスキップしてインポート
→ 重複エントリを回避
→ スマートな重複検出
```

#### ノートの生成

**日次ノート：**
```
あなた: 今日の作業から日記ノートを作成
→ 時系列の日次ノートを作成
→ 今日のメモリを含む
→ 関連するメモリを自動検出
```

**サマリーノート：**
```
あなた: 学習カテゴリからサマリーノートを生成
→ 整理されたサマリーを作成
→ トピックとテーマでグループ化
→ 統計とメタデータを含む
```

**プロジェクトレポート：**
```
あなた: プロジェクト関連の記憶からレポート作成
→ 構造化されたプロジェクト文書
→ 進捗追跡を含む
→ プロフェッショナルなレポート形式
```

## 🛠️ 開発コマンド

```bash
# プロジェクトのビルド
make build

# テストの実行
make test

# 品質チェック（フォーマット、リント、テスト）
make quality

# テストカバレッジの生成
make test-coverage

# ビルド成果物のクリーンアップ
make clean
```

## 🐛 トラブルシューティング

### よくある問題

#### 1. Claude DesktopでMoryツールが表示されない
- **確認**: 設定ファイルの構文（有効なJSON）
- **確認**: バイナリへの絶対パス
- **解決策**: Claude Desktopを完全に再起動

#### 2. "Command not found" エラー
- **確認**: バイナリが存在し実行可能であること
- **解決策**: `make build` を実行し `./bin/mory --version` で確認

#### 3. Obsidianインポートが失敗する
- **確認**: ボルトパスが正しくアクセス可能であること
- **確認**: 環境変数または設定ファイルのセットアップ
- **解決策**: `ls "$MORY_OBSIDIAN_VAULT_PATH"` でテスト

#### 4. メモリが永続化されない
- **確認**: データディレクトリのアクセス権限
- **確認**: ディスク容量の可用性
- **解決策**: `~/.mory/` ディレクトリとログを確認

### デバッグ情報

デバッグログを有効化：
```bash
export MORY_DEBUG=true
./bin/mory
```

データファイルの確認：
```bash
ls -la ~/.mory/
cat ~/.mory/memories.json
tail ~/.mory/operations.log
```

## 🎯 使用パターンとコツ

### 効果的なメモリ管理
1. **明確なカテゴリを使用**: "学習"、"仕事"、"個人"、"プロジェクト"
2. **説明的なキーを追加**: 取得を容易にする
3. **関連するタグを含める**: 検索精度を向上
4. **定期的なクリーンアップ**: 古い情報を削除

### 検索のベストプラクティス
1. **具体的なキーワードを使用**: 一般的な用語より効果的
2. **カテゴリ＋検索を組み合わせ**: 結果を効果的に絞り込み
3. **関連度スコアを確認**: 高いスコア＝より良いマッチ
4. **検索語句を反復**: 異なる表現を試す

### Obsidian連携のコツ
1. **最初にボルトを整理**: きれいな構造＝より良いインポート
2. **フロントマターを使用**: 豊富なメタデータを提供
3. **一貫してタグ付け**: カテゴリ分類を向上
4. **ドライランでテスト**: インポート前にプレビュー
5. **ボルトをバックアップ**: 大規模インポートの前に

## 📚 次のステップ

1. **テンプレートを探索**: 異なるノート生成テンプレートを試す
2. **カテゴリをカスタマイズ**: 独自の整理システムを開発
3. **ワークフローに統合**: メモリ使用を習慣化
4. **貢献**: 改善点とフィードバックを共有

## 🔗 追加リソース

- **技術文書**: [API.md](./API.md)
- **貢献ガイド**: [CONTRIBUTING.md](./CONTRIBUTING.md)
- **プロジェクトホームページ**: [README.md](./README.md)
- **課題トラッカー**: [GitHub Issues](https://github.com/nyasuto/mory/issues)

---

**ヘルプが必要ですか？** GitHubでIssueを作成するか、上記のトラブルシューティングセクションを確認してください。

**うまく動作しますか？** リポジトリにスターを付けて、あなたの体験を共有することを検討してください！